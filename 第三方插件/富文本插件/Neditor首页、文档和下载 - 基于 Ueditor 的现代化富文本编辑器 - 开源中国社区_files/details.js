define("www_details",["msg","throttle","project"],function(msg,throttle,project){var Details=function(){this.__name="Details"};return Details.prototype={constructor:Details,initDetails:function(){new Vue({el:"#v-details",data:function(){return{mayunText:{size:36}}},methods:{},ready:function(){var t=$(this.$els.mayunjj).text().trim().length;t>12&&(this.mayunText.size=21),$("pre").each(function(t,e){var i,o,r=$(this),s=r.attr("class");s&&(i=s.match(/brush:([^;]+);/),i&&i.length>1&&(o=i[i.length-1],r.attr("class","hljs "+o)))}),$("pre").each(function(t,e){hljs.highlightBlock(e)})}})},initHeader:function(){var __me=this,is_owner=eval(__me.is_owner);new Vue({el:"#v-header",data:function(){return{author:{showPopupbox:!1,showMessage:!1,showLove:!1,love:{islove:!0,isloveEd:!0,hover:!1,url:"",val:""}},basic:{collected:!1,tag:"",text:"收藏"}}},methods:{msg:function(t){var e=this.author;return e.showPopupbox=!0,is_owner?void alert("不能给自己发送私信 : )"):void project.DetailsE.$emit("showPopupbox",t)},sendLove:function(){var t=this.author,e=t.love.val,i=t.love.url;return is_owner?void alert("不能关注自己 : )"):(i="1"===e?"/action/user/follow":"/action/user/unfollow",t.love.hover||(t.love.hover=!0),void project.ajax_post(i,{user:__me.user_id,id:__me.user_receiver,user_code:__me.user_code,temp:(new Date).getTime()},function(e){t.love.val=e,t.love.hover=!1,"1"===e&&(t.love.islove=!0,t.love.isloveEd=!1),"2"!==e&&"3"!==e||(t.love.isloveEd=!0,t.love.islove=!1)}))},sedCom:function(t){var e=this.author;e.showPopupbox=!0,project.DetailsE.$emit("showPopupbox",t)},collect:function(){var t=this.basic,e=__me.favorite_url,i=this.$els.num;project.ajax_post(e,{id:__me.project_id,type:__me.object_type_id,tags:t.tag},function(e){if(!isNaN(e))return t.collected=!0,t.text="已收藏",void $(i).text(e)})},cancel:function(){var t=this.basic,e="/action/favorite/cancel",i=this.$els.num;t.collected&&project.ajax_post(e,{id:__me.project_id,type:__me.object_type_id,user:__me.user_id},function(e){t.collected=!1,t.text="收藏",$(i).text(e)})}},ready:function(){var t=this;"true"===__me.user_favorited&&(t.basic.collected=!0,t.basic.text="已收藏")}})},initSimilar:function(){new Vue({el:"#v-similar"})},initEidt:function(){var t,e=this;$("#ta_prj_detail").length>0&&CKEDITOR.replace("ta_prj_detail",{height:231,weight:400,extraPlugins:"autogrow,uploadimage,flash,video",autoGrow_onStartup:!0,autoGrow_minHeight:231,autoGrow_maxHeight:1e3}),t=$(".btn-submit"),$("#form_project").ajaxForm({beforeSerialize:function(e,i){var o=CKEDITOR.instances.ta_prj_detail.getData();return $("#ta_prj_detail").html(o),0==$("#reason").val().length?(alert("请填写修改原因"),!1):$("#reason").val().length>200?(alert("编辑理由仅限200个字符"),!1):void t.attr("disabled",!0)},success:function(i){var o,r,s;$("#error_msg").hide(),t.attr("disabled",!1),i.length>0?$("#error_msg").html("<span class='error_msg'>"+i+"</span>"):(o=e.isCanEdit,r="",s=e.iurl,r=o?"资料修改成功，<a href='"+s+"'>返回详情页。</a>":"您的内容已经提交，系统需要花费一段时间检查您的版本。",$("#error_msg").html("<span class='ok_msg'>"+r+"</span>")),$("#error_msg").show("fast")}})},top:function(t){var e=$(".sc-tool-backtop"),i=function(){var i=t.scrollTop();i>200?e.removeClass("hide").addClass("show"):e.removeClass("show").addClass("hide")};i(),throttle.requestAnimationFrame(i,300),e.bind("click",function(){$("html, body").stop().animate({scrollTop:0},"500","swing")})},initGithub:function(){var t,e,i=this;"true"==i.isFromGithub&&(t=document.createElement("script"),t.type="text/javascript",t.async=!0,t.src=i.githubRepoWidgetUrl,e=document.getElementsByTagName("script")[0],e.parentNode.insertBefore(t,e))},register:function(){this.top($(window)),project.initComponent(this),this.initHeader(),project.initPopupbox(this),this.initDetails(),this.initSimilar(),project.initCom(this),this.initEidt(),this.g_user_login&&msg.polling(this.polling_msg_tips_url),this.initGithub()}},Details});